<style>
    .shipping_wholesale{
        color: #FF0000;
        font-weight: bold;
    }
</style>
<script>
    (function ($) {
        $.wholesale_shipping_plugin = {
            options: {},
            init: function (options) {
                this.options = options;
                this.changeShipping();
                $('input[name=shipping_id]:checked').change();

            },
            locking: function (message) {
                $(this.options.submit_selector).attr('disabled', true);
                $('.shipping_wholesale').text(message);
            },
            unlocking: function () {
                $(this.options.submit_selector).removeAttr('disabled');
                $('.shipping_wholesale').text('');
            },
            changeShipping: function () {
                var self = this;
                $(document).off('change', 'input[name=shipping_id]').on('change', 'input[name=shipping_id]', function () {
                    var shipping_id = $(this).val();
                    $('.shipping_wholesale').html('<i class="icon16 loading"></i>');
                    $(self.options.submit_selector).attr('disabled', true);
                    $.ajax({
                        type: 'POST',
                        url: self.options.checkUrl,
                        dataType: 'json',
                        data: {
                            shipping_id: shipping_id
                        },
                        success: function (data, textStatus, jqXHR) {
                            $(self.options.submit_selector).removeAttr('disabled');
                            if (data.data.check.result) {
                                self.unlocking();
                            } else {
                                self.locking(data.data.check.message);
                            }
                        }
                    });
                });
            }
        };
    })(jQuery);
    $(function () {
        $.wholesale_shipping_plugin.init({
            checkUrl: '{$wa_app_url}wholesale/shipping/',
            submit_selector: '{$settings.shipping_submit_selector|default:''}'
        });
    });

</script>

<div class="shipping_wholesale"></div>